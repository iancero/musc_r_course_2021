<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Structural Equation Modeling | An Organic R Textbook</title>
  <meta name="description" content="This is the organic textbook accompanying Cero’s 2021 course on statistical programming with R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Structural Equation Modeling | An Organic R Textbook" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://iancero.github.io/musc_r_course_2021" />
  
  <meta property="og:description" content="This is the organic textbook accompanying Cero’s 2021 course on statistical programming with R" />
  <meta name="github-repo" content="iancero/musc_r_course_2021" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Structural Equation Modeling | An Organic R Textbook" />
  
  <meta name="twitter:description" content="This is the organic textbook accompanying Cero’s 2021 course on statistical programming with R" />
  

<meta name="author" content="Ian Cero, PhD MStat" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="introduction-to-machine-learning.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#overview-of-the-r-ecosystem"><i class="fa fa-check"></i><b>2.1</b> Overview of the R ecosystem</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#step-1---download-and-install-the-r-language"><i class="fa fa-check"></i><b>2.2.1</b> Step 1 - Download and install the R language</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#step-2---download-and-install-the-rstudio-ide"><i class="fa fa-check"></i><b>2.2.2</b> Step 2 - Download and install the RStudio IDE</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started.html"><a href="getting-started.html#step-3---install-the-tidyverse-package-optional"><i class="fa fa-check"></i><b>2.2.3</b> Step 3 - Install the <code>tidyverse</code> package (optional)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#a-tour-of-rstudio"><i class="fa fa-check"></i><b>2.3</b> A tour of RStudio</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#the-console"><i class="fa fa-check"></i><b>2.3.1</b> The console</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-started.html"><a href="getting-started.html#the-environment"><i class="fa fa-check"></i><b>2.3.2</b> The environment</a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-started.html"><a href="getting-started.html#the-lower-right-pane"><i class="fa fa-check"></i><b>2.3.3</b> The lower right pane</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#your-very-first-analysis"><i class="fa fa-check"></i><b>2.4</b> Your very first analysis</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started.html"><a href="getting-started.html#step-1---download-the-data"><i class="fa fa-check"></i><b>2.4.1</b> Step 1 - download the data</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-started.html"><a href="getting-started.html#step-2---make-an-rstudio-project"><i class="fa fa-check"></i><b>2.4.2</b> Step 2 - Make an RStudio Project</a></li>
<li class="chapter" data-level="2.4.3" data-path="getting-started.html"><a href="getting-started.html#step-3---get-the-data-into-your-project-folder"><i class="fa fa-check"></i><b>2.4.3</b> Step 3 - Get the data into your project folder</a></li>
<li class="chapter" data-level="2.4.4" data-path="getting-started.html"><a href="getting-started.html#step-4---open-an-rmarkdown-notebook"><i class="fa fa-check"></i><b>2.4.4</b> Step 4 - Open an Rmarkdown Notebook</a></li>
<li class="chapter" data-level="2.4.5" data-path="getting-started.html"><a href="getting-started.html#step-5---create-a-space-to-code"><i class="fa fa-check"></i><b>2.4.5</b> Step 5 - Create a space to code</a></li>
<li class="chapter" data-level="2.4.6" data-path="getting-started.html"><a href="getting-started.html#step-6---write-a-command-to-import-the-data"><i class="fa fa-check"></i><b>2.4.6</b> Step 6 - Write a command to import the data</a></li>
<li class="chapter" data-level="2.4.7" data-path="getting-started.html"><a href="getting-started.html#step-7---look-inside-the-data"><i class="fa fa-check"></i><b>2.4.7</b> Step 7 - Look inside the data</a></li>
<li class="chapter" data-level="2.4.8" data-path="getting-started.html"><a href="getting-started.html#step-8---make-a-histogram"><i class="fa fa-check"></i><b>2.4.8</b> Step 8 - Make a histogram</a></li>
<li class="chapter" data-level="2.4.9" data-path="getting-started.html"><a href="getting-started.html#step-9---run-a-regression"><i class="fa fa-check"></i><b>2.4.9</b> Step 9 - Run a regression</a></li>
<li class="chapter" data-level="2.4.10" data-path="getting-started.html"><a href="getting-started.html#step-10---get-a-summary-of-your-results"><i class="fa fa-check"></i><b>2.4.10</b> Step 10 - Get a summary of your results</a></li>
<li class="chapter" data-level="2.4.11" data-path="getting-started.html"><a href="getting-started.html#a-look-forward"><i class="fa fa-check"></i><b>2.4.11</b> A Look forward</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>3</b> Basic R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-r.html"><a href="basic-r.html#writing-in-r-and-rmarkdown"><i class="fa fa-check"></i><b>3.1</b> Writing in R and Rmarkdown</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r.html"><a href="basic-r.html#chatting-with-r"><i class="fa fa-check"></i><b>3.1.1</b> Chatting with R</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r.html"><a href="basic-r.html#rmarkdown-tricks"><i class="fa fa-check"></i><b>3.1.2</b> Rmarkdown tricks</a></li>
<li class="chapter" data-level="3.1.3" data-path="basic-r.html"><a href="basic-r.html#code-blocks"><i class="fa fa-check"></i><b>3.1.3</b> Code blocks</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r.html"><a href="basic-r.html#variables"><i class="fa fa-check"></i><b>3.2</b> Variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r.html"><a href="basic-r.html#the-assignment-operator"><i class="fa fa-check"></i><b>3.2.1</b> The assignment operator</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-r.html"><a href="basic-r.html#numerics"><i class="fa fa-check"></i><b>3.2.2</b> Numerics</a></li>
<li class="chapter" data-level="3.2.3" data-path="basic-r.html"><a href="basic-r.html#characters"><i class="fa fa-check"></i><b>3.2.3</b> Characters</a></li>
<li class="chapter" data-level="3.2.4" data-path="basic-r.html"><a href="basic-r.html#booleans"><i class="fa fa-check"></i><b>3.2.4</b> Booleans</a></li>
<li class="chapter" data-level="3.2.5" data-path="basic-r.html"><a href="basic-r.html#special-types"><i class="fa fa-check"></i><b>3.2.5</b> Special types</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r.html"><a href="basic-r.html#vectors"><i class="fa fa-check"></i><b>3.3</b> Vectors</a></li>
<li class="chapter" data-level="3.4" data-path="basic-r.html"><a href="basic-r.html#lists"><i class="fa fa-check"></i><b>3.4</b> Lists</a></li>
<li class="chapter" data-level="3.5" data-path="basic-r.html"><a href="basic-r.html#dataframes"><i class="fa fa-check"></i><b>3.5</b> Dataframes</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basic-r.html"><a href="basic-r.html#construction"><i class="fa fa-check"></i><b>3.5.1</b> Construction</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-r.html"><a href="basic-r.html#built-in-dataframes"><i class="fa fa-check"></i><b>3.5.2</b> Built-in dataframes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-r.html"><a href="basic-r.html#functions"><i class="fa fa-check"></i><b>3.6</b> Functions</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="basic-r.html"><a href="basic-r.html#getting-help"><i class="fa fa-check"></i><b>3.6.1</b> Getting help</a></li>
<li class="chapter" data-level="3.6.2" data-path="basic-r.html"><a href="basic-r.html#function-parameters"><i class="fa fa-check"></i><b>3.6.2</b> Function parameters</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="basic-r.html"><a href="basic-r.html#packages"><i class="fa fa-check"></i><b>3.7</b> Packages</a></li>
<li class="chapter" data-level="3.8" data-path="basic-r.html"><a href="basic-r.html#error-messages"><i class="fa fa-check"></i><b>3.8</b> Error messages</a></li>
<li class="chapter" data-level="3.9" data-path="basic-r.html"><a href="basic-r.html#coding-conventions"><i class="fa fa-check"></i><b>3.9</b> Coding Conventions</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="basic-r.html"><a href="basic-r.html#what-should-my-code-look-like"><i class="fa fa-check"></i><b>3.9.1</b> What should my code look like?</a></li>
<li class="chapter" data-level="3.9.2" data-path="basic-r.html"><a href="basic-r.html#official-coding-conventions"><i class="fa fa-check"></i><b>3.9.2</b> Official coding conventions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html"><i class="fa fa-check"></i><b>4</b> Introduction to machine learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#wait-arent-those-the-same-thing"><i class="fa fa-check"></i><b>4.1</b> Wait, aren’t those the same thing?</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#the-tidymodels-framework"><i class="fa fa-check"></i><b>4.2</b> The <code>tidymodels</code> framework</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#steps-1-2---load-data-and-do-some-very-basic-cleaning"><i class="fa fa-check"></i><b>4.3</b> Steps 1 &amp; 2 - Load data and do some very basic cleaning</a></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-3---split-training-and-test-samples"><i class="fa fa-check"></i><b>4.4</b> Step 3 - Split training and test samples</a></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-4---build-a-data-processing-recipe"><i class="fa fa-check"></i><b>4.5</b> Step 4 - Build a data processing recipe</a></li>
<li class="chapter" data-level="4.6" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-5---extract-the-preprocessed-data"><i class="fa fa-check"></i><b>4.6</b> Step 5 - Extract the preprocessed data</a></li>
<li class="chapter" data-level="4.7" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-6---fit-a-model"><i class="fa fa-check"></i><b>4.7</b> Step 6 - Fit a model</a></li>
<li class="chapter" data-level="4.8" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-7---evaluate-the-model"><i class="fa fa-check"></i><b>4.8</b> Step 7 - Evaluate the model</a></li>
<li class="chapter" data-level="4.9" data-path="introduction-to-machine-learning.html"><a href="introduction-to-machine-learning.html#step-8---plot-your-data"><i class="fa fa-check"></i><b>4.9</b> Step 8 - Plot your data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html"><i class="fa fa-check"></i><b>5</b> Structural Equation Modeling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#step-1-and-2---load-data-and-clean"><i class="fa fa-check"></i><b>5.1</b> Step 1 and 2 - Load data and clean</a></li>
<li class="chapter" data-level="5.2" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#efa"><i class="fa fa-check"></i><b>5.2</b> EFA</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#steps-3-4"><i class="fa fa-check"></i><b>5.2.1</b> Steps 3 &amp; 4</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#cfa"><i class="fa fa-check"></i><b>5.3</b> CFA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#step-3-4"><i class="fa fa-check"></i><b>5.3.1</b> Step 3 &amp; 4</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#sem"><i class="fa fa-check"></i><b>5.4</b> SEM</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#steps-3-4-1"><i class="fa fa-check"></i><b>5.4.1</b> Steps 3 &amp; 4</a></li>
<li class="chapter" data-level="5.4.2" data-path="structural-equation-modeling.html"><a href="structural-equation-modeling.html#modification-indices"><i class="fa fa-check"></i><b>5.4.2</b> Modification indices</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Organic R Textbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="structural-equation-modeling" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Structural Equation Modeling</h1>
<p>Structural equation modeling (SEM) can be thought of as a series of regressions, all estimated simultaneously. This allows the relationship between some variables to provide information on the relationship between others. To get a feel for how this works, consider that if we have three variables (A, B, C) and two negative correlations (A is negatively correlated with B, B is negatively correlated with C), we know that A and C MUST be positively correlated. Thus, if I estimate all of these correlations simultaneously, I can get a more precise estimate for all of their relationships by incorporating all possible information.</p>
<p>There are many kinds of SEMS, so we’ll cover just a few of the most common ones:</p>
<ul>
<li><p>Exploratory factor analysis (EFA), in which we ask whether some hidden factor accounts for the observed correlation between several items (usually items from the same survey scale). In the case of EFA, we also don’t really have any prior knowledge as to what this hidden variable might be like, so we let the model figure it out for us.</p></li>
<li><p>Confirmatory factor analysis (CFA), which is like EFA, but we force the model to fit an <em>a priori</em> idea that we have about the relationship between our observed variables and the hidden variable that explains their correlations. After we force a specific model, we then evaluate how well it fit our observed data.</p></li>
<li><p>Path models. These are often what people think of when they hear “SEM.” These are typically just a series of regressions (paths) connecting variables in a kind of spider web of relationships.</p></li>
</ul>
<div id="step-1-and-2---load-data-and-clean" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Step 1 and 2 - Load data and clean</h2>
<p>Because we want to evaluate the factors underlying particular scales, we’ll start by using the <code>diff_emotion_reg_p01.txt</code> dataset, which includes data from an emotion regulation survey scale.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="structural-equation-modeling.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb151-2"><a href="structural-equation-modeling.html#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="structural-equation-modeling.html#cb151-3" aria-hidden="true" tabindex="-1"></a>read_abcd_quietly <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path){</span>
<span id="cb151-4"><a href="structural-equation-modeling.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(</span>
<span id="cb151-5"><a href="structural-equation-modeling.html#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">expr =</span> <span class="fu">read_delim</span>(file_path, <span class="at">delim =</span> <span class="st">&#39;</span><span class="sc">\t</span><span class="st">&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-6"><a href="structural-equation-modeling.html#cb151-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-7"><a href="structural-equation-modeling.html#cb151-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">type_convert</span>())</span>
<span id="cb151-8"><a href="structural-equation-modeling.html#cb151-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-9"><a href="structural-equation-modeling.html#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="structural-equation-modeling.html#cb151-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_abcd_quietly</span>(<span class="st">&#39;data/diff_emotion_reg_p01.txt&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb151-11"><a href="structural-equation-modeling.html#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">&#39;ders_&#39;</span>), <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="dv">7</span>, <span class="cn">NA</span>, .x)))</span></code></pre></div>
</div>
<div id="efa" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> EFA</h2>
<div id="steps-3-4" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Steps 3 &amp; 4</h3>
<p>To conduct an EFA, we’ll use functions from the <code>psych</code> package. This process is luckily relatively straightforward. All we need to do is select the variables we want to analyze, then feed them to the <code>fa()</code> function. The <code>fa()</code> function also wants to know what the max number of factors we want to look for is, so we’ll tell it 6 (it this case, we know this scale has 6 factors because it has been extensively studied before).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="structural-equation-modeling.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb152-2"><a href="structural-equation-modeling.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="structural-equation-modeling.html#cb152-3" aria-hidden="true" tabindex="-1"></a>ders_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="structural-equation-modeling.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&#39;ders_&#39;</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">&#39;_p&#39;</span>))</span>
<span id="cb152-5"><a href="structural-equation-modeling.html#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="structural-equation-modeling.html#cb152-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fa</span>(ders_df, <span class="at">nfactors =</span> <span class="dv">6</span>)</span>
<span id="cb152-7"><a href="structural-equation-modeling.html#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="structural-equation-modeling.html#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Factor analysis with Call: fa(r = ders_df, nfactors = 6)
## 
## Test of the hypothesis that 6 factors are sufficient.
## The degrees of freedom for the model is 247  and the objective function was  3.01 
## The number of observations was  6251  with Chi Square =  18775.94  with prob &lt;  0 
## 
## The root mean square of the residuals (RMSA) is  0.02 
## The df corrected root mean square of the residuals is  0.03 
## 
## Tucker Lewis Index of factoring reliability =  0.837
## RMSEA index =  0.11  and the 10 % confidence intervals are  0.108 0.111
## BIC =  16617.04
##  With factor correlations of 
##      MR5  MR2  MR1  MR4  MR3  MR6
## MR5 1.00 0.56 0.53 0.61 0.55 0.57
## MR2 0.56 1.00 0.31 0.51 0.45 0.63
## MR1 0.53 0.31 1.00 0.33 0.46 0.38
## MR4 0.61 0.51 0.33 1.00 0.50 0.47
## MR3 0.55 0.45 0.46 0.50 1.00 0.45
## MR6 0.57 0.63 0.38 0.47 0.45 1.00</code></pre>
<p>Unfortunately, the output we get from <code>summary()</code> doesn’t tell us which items load onto which factors. To get that, we need to extract them from the <code>fit</code> object directly.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="structural-equation-modeling.html#cb154-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>loadings</span></code></pre></div>
<pre><code>## 
## Loadings:
##                                MR5    MR2    MR1    MR4    MR3    MR6   
## ders_attn_awareness_p                  0.953                            
## ders_clear_feelings_p                  0.902                            
## ders_emotion_overwhelm_p        0.119  0.543 -0.107  0.128              
## ders_feelings_attentive_p              0.662                            
## ders_feelings_care_p                                               0.903
## ders_feelings_know_p                   0.278         0.112         0.511
## ders_upset_ack_p                0.174  0.243 -0.163  0.120  0.184  0.281
## ders_upset_angry_p                            0.149  0.635         0.185
## ders_upset_ashamed_p            0.169  0.129  0.546  0.271              
## ders_upset_behavior_control_p   0.224         0.228  0.303              
## ders_upset_behavior_p           0.853                                   
## ders_upset_better_p             0.311         0.161  0.112  0.111  0.140
## ders_upset_concentrate_p        0.673                      -0.104  0.192
## ders_upset_control_p            0.504        -0.265  0.349  0.275       
## ders_upset_depressed_p          0.138         0.218         0.581       
## ders_upset_difficulty_p         0.262  0.272         0.366              
## ders_upset_embarrassed_p                      0.162  0.677         0.217
## ders_upset_emotion_overwhelm_p  0.521         0.247                     
## ders_upset_esteem_p             0.200         0.489         0.296  0.128
## ders_upset_feel_better_p        0.345  0.130  0.416         0.176       
## ders_upset_fixation_p           0.834                                   
## ders_upset_focus_p              0.365  0.220 -0.139  0.397  0.150       
## ders_upset_guilty_p                           0.640  0.132  0.121       
## ders_upset_irritation_p         0.231  0.108  0.548  0.130         0.112
## ders_upset_long_time_better_p   0.606  0.136                       0.138
## ders_upset_lose_control_p       0.657                0.106              
## ders_upset_out_control_p        0.304  0.171  0.211  0.383  0.109 -0.185
## ders_upset_time_p                                           0.997       
## ders_upset_weak_p                             0.495         0.216       
## 
##                  MR5   MR2   MR1   MR4   MR3   MR6
## SS loadings    3.977 2.845 2.105 1.718 1.723 1.426
## Proportion Var 0.137 0.098 0.073 0.059 0.059 0.049
## Cumulative Var 0.137 0.235 0.308 0.367 0.426 0.476</code></pre>
</div>
</div>
<div id="cfa" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> CFA</h2>
<div id="step-3-4" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Step 3 &amp; 4</h3>
<p>Above, we did an exploratory factor analysis, but now we want to run a confirmatory one. To do that, we’ll use the <code>lavaan</code> package, which is the most popular pacakge in R for SEM-based analyses.</p>
<p>Like a basic regression, we’ll need a model formula and some data. But unlike a basic regression, CFA and broader SEM usually have several formulas at once. To handle this, we’ll write down our model as a string and save it in a <code>my_model</code> variable to make things easier to read.</p>
<p>After that, we just send the model to the <code>cfa()</code> function, which does the rest of the work for us. A quick call to <code>summary()</code> and we’re done!</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="structural-equation-modeling.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb156-2"><a href="structural-equation-modeling.html#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="structural-equation-modeling.html#cb156-3" aria-hidden="true" tabindex="-1"></a>my_model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb156-4"><a href="structural-equation-modeling.html#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="st">  b =~ ders_attn_awareness_p + ders_clear_feelings_p + ders_emotion_overwhelm_p + ders_feelings_attentive_p + ders_feelings_care_p + ders_feelings_know_p + ders_upset_ack_p</span></span>
<span id="cb156-5"><a href="structural-equation-modeling.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb156-6"><a href="structural-equation-modeling.html#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="st">  c =~ ders_upset_angry_p + ders_upset_control_p + ders_upset_difficulty_p + ders_upset_embarrassed_p + ders_upset_focus_p + ders_upset_out_control_p</span></span>
<span id="cb156-7"><a href="structural-equation-modeling.html#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb156-8"><a href="structural-equation-modeling.html#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="st">  a =~ ders_upset_ashamed_p + ders_upset_behavior_control_p + ders_upset_depressed_p + ders_upset_esteem_p + ders_upset_feel_better_p + ders_upset_guilty_p + ders_upset_irritation_p + ders_upset_time_p + ders_upset_weak_p</span></span>
<span id="cb156-9"><a href="structural-equation-modeling.html#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb156-10"><a href="structural-equation-modeling.html#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="st">  d =~ ders_upset_behavior_p + ders_upset_better_p + ders_upset_concentrate_p + ders_upset_emotion_overwhelm_p + ders_upset_fixation_p + ders_upset_long_time_better_p + ders_upset_lose_control_p</span></span>
<span id="cb156-11"><a href="structural-equation-modeling.html#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb156-12"><a href="structural-equation-modeling.html#cb156-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-13"><a href="structural-equation-modeling.html#cb156-13" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(</span>
<span id="cb156-14"><a href="structural-equation-modeling.html#cb156-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> my_model,</span>
<span id="cb156-15"><a href="structural-equation-modeling.html#cb156-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df)</span>
<span id="cb156-16"><a href="structural-equation-modeling.html#cb156-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-17"><a href="structural-equation-modeling.html#cb156-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">fit.measures =</span> T)</span></code></pre></div>
<pre><code>## lavaan 0.6-11 ended normally after 300 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        64
##                                                       
##                                                   Used       Total
##   Number of observations                          6147        6251
##                                                                   
## Model Test User Model:
##                                                        
##   Test statistic                              35452.539
##   Degrees of freedom                                371
##   P-value (Chi-square)                            0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                            184927.008
##   Degrees of freedom                               406
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.810
##   Tucker-Lewis Index (TLI)                       0.792
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)            -877024.922
##   Loglikelihood unrestricted model (H1)    -859298.653
##                                                       
##   Akaike (AIC)                             1754177.844
##   Bayesian (BIC)                           1754608.163
##   Sample-size adjusted Bayesian (BIC)      1754404.788
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.124
##   90 Percent confidence interval - lower         0.123
##   90 Percent confidence interval - upper         0.125
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.058
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   b =~                                                
##     drs_ttn_wrnss_    1.000                           
##     drs_clr_flngs_    0.928    0.011   85.836    0.000
##     drs_mtn_vrwhl_    0.730    0.015   49.818    0.000
##     drs_flngs_ttn_    1.071    0.017   62.857    0.000
##     drs_flngs_cr_p    0.985    0.013   73.134    0.000
##     drs_flngs_knw_    1.020    0.013   80.144    0.000
##     ders_upst_ck_p    0.760    0.012   63.093    0.000
##   c =~                                                
##     drs_pst_ngry_p    1.000                           
##     drs_pst_cntrl_    0.702    0.008   84.481    0.000
##     drs_pst_dffcl_    0.773    0.011   71.472    0.000
##     drs_pst_mbrrs_    0.986    0.012   81.388    0.000
##     ders_pst_fcs_p    0.790    0.009   87.752    0.000
##     drs_pst_t_cnt_    0.870    0.012   72.614    0.000
##   a =~                                                
##     drs_pst_shmd_p    1.000                           
##     drs_pst_bhvr__    0.830    0.014   60.223    0.000
##     drs_pst_dprss_    0.871    0.010   86.053    0.000
##     ders_pst_stm_p    1.022    0.010  100.690    0.000
##     drs_pst_fl_bt_    0.931    0.009  102.532    0.000
##     drs_pst_glty_p    1.128    0.012   94.694    0.000
##     drs_pst_rrttn_    1.003    0.009  114.024    0.000
##     ders_upst_tm_p    0.758    0.012   64.555    0.000
##     ders_upst_wk_p    1.073    0.016   68.799    0.000
##   d =~                                                
##     drs_pst_bhvr_p    1.000                           
##     drs_pst_bttr_p    1.041    0.017   61.130    0.000
##     drs_pst_cncnt_    1.059    0.011   94.852    0.000
##     drs_pst_mtn_v_    1.246    0.014   91.898    0.000
##     drs_pst_fxtn_p    1.187    0.011  105.360    0.000
##     drs_pst_lng___    1.139    0.012   92.068    0.000
##     drs_pst_ls_cn_    0.977    0.010   93.973    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   b ~~                                                
##     c              1306.707   31.057   42.074    0.000
##     a              1314.713   32.965   39.882    0.000
##     d               977.803   23.843   41.010    0.000
##   c ~~                                                
##     a              1889.998   43.083   43.868    0.000
##     d              1409.192   31.338   44.968    0.000
##   a ~~                                                
##     d              1647.825   35.449   46.485    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .drs_ttn_wrnss_  513.518   11.572   44.378    0.000
##    .drs_clr_flngs_  406.478    9.368   43.391    0.000
##    .drs_mtn_vrwhl_ 1338.981   25.163   53.212    0.000
##    .drs_flngs_ttn_ 1574.552   30.665   51.347    0.000
##    .drs_flngs_cr_p  842.167   17.209   48.936    0.000
##    .drs_flngs_knw_  652.877   14.069   46.406    0.000
##    .ders_upst_ck_p  785.343   15.308   51.303    0.000
##    .drs_pst_ngry_p  762.693   16.279   46.851    0.000
##    .drs_pst_cntrl_  396.881    8.388   47.316    0.000
##    .drs_pst_dffcl_  864.936   16.978   50.945    0.000
##    .drs_pst_mbrrs_  905.787   18.706   48.423    0.000
##    .ders_pst_fcs_p  428.311    9.333   45.890    0.000
##    .drs_pst_t_cnt_ 1041.786   20.543   50.713    0.000
##    .drs_pst_shmd_p  645.893   13.927   46.376    0.000
##    .drs_pst_bhvr__ 2521.764   46.826   53.854    0.000
##    .drs_pst_dprss_ 1100.835   21.405   51.429    0.000
##    .ders_pst_stm_p  918.441   18.823   48.794    0.000
##    .drs_pst_fl_bt_  714.048   14.770   48.343    0.000
##    .drs_pst_glty_p 1376.005   27.494   50.048    0.000
##    .drs_pst_rrttn_  538.793   12.109   44.496    0.000
##    .ders_upst_tm_p 1781.098   33.250   53.566    0.000
##    .ders_upst_wk_p 3045.811   57.202   53.247    0.000
##    .drs_pst_bhvr_p  341.520    7.431   45.958    0.000
##    .drs_pst_bttr_p 1865.524   34.818   53.580    0.000
##    .drs_pst_cncnt_  568.218   11.578   49.079    0.000
##    .drs_pst_mtn_v_  874.766   17.593   49.723    0.000
##    .drs_pst_fxtn_p  482.445   10.491   45.987    0.000
##    .drs_pst_lng___  726.835   14.628   49.688    0.000
##    .drs_pst_ls_cn_  499.455   10.135   49.279    0.000
##     b              1331.862   32.715   40.710    0.000
##     c              1973.464   48.190   40.951    0.000
##     a              2650.912   58.812   45.074    0.000
##     d              1316.773   29.564   44.539    0.000</code></pre>
</div>
</div>
<div id="sem" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> SEM</h2>
<div id="steps-3-4-1" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Steps 3 &amp; 4</h3>
<p>The CFA above shows us that there are several latent variables that underlie the scale in this dataset, which we have labelled <code>a</code> through <code>d</code>. Do the scores on one factor predict scores on another? Does the sex of a subject predict their scores on these hidden variables? SEM is the technique that answers this question. All we need to to to get there is to combine our existing model with some existing commands.</p>
<p>Here, we are saying that we expect variable <code>a</code> to be predicted by variable <code>b</code>, as well as subject sex.</p>
<p>To demonstrate another trick in the next line, we’ll tell R that we want our model to force the correlation between <code>b</code> and <code>c</code> to be exactly 0. Why do this? In this case, there isn’t really a reason, but in broader SEM it helps to have this tool in your belt, so we demonstrate how to force model constraintes here in case you ever need them.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="structural-equation-modeling.html#cb158-1" aria-hidden="true" tabindex="-1"></a>new_model <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb158-2"><a href="structural-equation-modeling.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  my_model, </span>
<span id="cb158-3"><a href="structural-equation-modeling.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;</span></span>
<span id="cb158-4"><a href="structural-equation-modeling.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="st">  a ~ b + sex</span></span>
<span id="cb158-5"><a href="structural-equation-modeling.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="st">  b ~~ 0*c&#39;</span>)</span></code></pre></div>
<p>With our new model specified, we can safely proceed to estimate our SEM and ask for a summary in the usual way.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="structural-equation-modeling.html#cb159-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(</span>
<span id="cb159-2"><a href="structural-equation-modeling.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> new_model,</span>
<span id="cb159-3"><a href="structural-equation-modeling.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb159-4"><a href="structural-equation-modeling.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">&#39;MLR&#39;</span>,</span>
<span id="cb159-5"><a href="structural-equation-modeling.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">missing =</span> <span class="st">&#39;ML&#39;</span>)</span>
<span id="cb159-6"><a href="structural-equation-modeling.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="structural-equation-modeling.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## lavaan 0.6-11 ended normally after 433 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        91
##                                                       
##   Number of observations                          6251
##   Number of missing patterns                         2
##                                                       
## Model Test User Model:
##                                                 Standard      Robust
##   Test Statistic                               44875.439     969.709
##   Degrees of freedom                                 402         402
##   P-value (Chi-square)                             0.000       0.000
##   Scaling correction factor                                   46.277
##        Yuan-Bentler correction (Mplus variant)                      
## 
## Parameter Estimates:
## 
##   Standard errors                             Sandwich
##   Information bread                           Observed
##   Observed information based on                Hessian
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   b =~                                                
##     drs_ttn_wrnss_    1.000                           
##     drs_clr_flngs_    0.922    0.045   20.477    0.000
##     drs_mtn_vrwhl_    0.712    0.118    6.055    0.000
##     drs_flngs_ttn_    1.073    0.087   12.339    0.000
##     drs_flngs_cr_p    0.971    0.203    4.783    0.000
##     drs_flngs_knw_    1.002    0.170    5.885    0.000
##     ders_upst_ck_p    0.739    0.169    4.381    0.000
##   c =~                                                
##     drs_pst_ngry_p    1.000                           
##     drs_pst_cntrl_    0.716    0.102    7.009    0.000
##     drs_pst_dffcl_    0.771    0.102    7.584    0.000
##     drs_pst_mbrrs_    0.993    0.022   46.136    0.000
##     ders_pst_fcs_p    0.796    0.091    8.765    0.000
##     drs_pst_t_cnt_    0.870    0.075   11.650    0.000
##   a =~                                                
##     drs_pst_shmd_p    1.000                           
##     drs_pst_bhvr__    0.813    0.080   10.207    0.000
##     drs_pst_dprss_    0.867    0.093    9.342    0.000
##     ders_pst_stm_p    1.022    0.070   14.501    0.000
##     drs_pst_fl_bt_    0.921    0.068   13.504    0.000
##     drs_pst_glty_p    1.134    0.056   20.143    0.000
##     drs_pst_rrttn_    1.001    0.053   18.806    0.000
##     ders_upst_tm_p    0.758    0.106    7.132    0.000
##     ders_upst_wk_p    1.076    0.079   13.565    0.000
##   d =~                                                
##     drs_pst_bhvr_p    1.000                           
##     drs_pst_bttr_p    1.026    0.099   10.395    0.000
##     drs_pst_cncnt_    1.058    0.106    9.990    0.000
##     drs_pst_mtn_v_    1.228    0.126    9.718    0.000
##     drs_pst_fxtn_p    1.184    0.108   10.985    0.000
##     drs_pst_lng___    1.138    0.108   10.570    0.000
##     drs_pst_ls_cn_    0.979    0.111    8.784    0.000
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   a ~                                                 
##     b                 0.994    0.179    5.553    0.000
##     sex              -0.200    1.011   -0.198    0.843
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   b ~~                                                
##     c                 0.000                           
##     d               331.406  212.968    1.556    0.120
##   c ~~                                                
##     d              1085.534  369.380    2.939    0.003
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .drs_ttn_wrnss_    6.262    0.548   11.437    0.000
##    .drs_clr_flngs_    5.890    0.503   11.719    0.000
##    .drs_mtn_vrwhl_    4.458    0.577    7.724    0.000
##    .drs_flngs_ttn_    7.605    0.710   10.711    0.000
##    .drs_flngs_cr_p    6.691    0.589   11.359    0.000
##    .drs_flngs_knw_    6.395    0.576   11.110    0.000
##    .ders_upst_ck_p    5.698    0.503   11.334    0.000
##    .drs_pst_ngry_p    5.373    0.666    8.069    0.000
##    .drs_pst_cntrl_    3.283    0.472    6.960    0.000
##    .drs_pst_dffcl_    5.246    0.577    9.098    0.000
##    .drs_pst_mbrrs_    5.460    0.678    8.058    0.000
##    .ders_pst_fcs_p    4.418    0.519    8.510    0.000
##    .drs_pst_t_cnt_    4.830    0.642    7.523    0.000
##    .drs_pst_shmd_p    6.082    1.722    3.531    0.000
##    .drs_pst_bhvr__    9.136    1.587    5.757    0.000
##    .drs_pst_dprss_    5.656    1.579    3.581    0.000
##    .ders_pst_stm_p    6.690    1.784    3.750    0.000
##    .drs_pst_fl_bt_    5.815    1.624    3.581    0.000
##    .drs_pst_glty_p    8.072    1.998    4.040    0.000
##    .drs_pst_rrttn_    6.049    1.748    3.460    0.001
##    .ders_upst_tm_p    6.030    1.464    4.118    0.000
##    .ders_upst_wk_p    9.695    2.009    4.826    0.000
##    .drs_pst_bhvr_p    3.928    0.519    7.562    0.000
##    .drs_pst_bttr_p    7.784    0.732   10.635    0.000
##    .drs_pst_cncnt_    5.052    0.577    8.761    0.000
##    .drs_pst_mtn_v_    5.647    0.689    8.194    0.000
##    .drs_pst_fxtn_p    5.027    0.617    8.153    0.000
##    .drs_pst_lng___    4.801    0.630    7.627    0.000
##    .drs_pst_ls_cn_    3.824    0.535    7.154    0.000
##     b                 0.000                           
##     c                 0.000                           
##    .a                 0.000                           
##     d                 0.000                           
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .drs_ttn_wrnss_  492.585  294.777    1.671    0.095
##    .drs_clr_flngs_  399.547  235.111    1.699    0.089
##    .drs_mtn_vrwhl_ 1359.647  332.156    4.093    0.000
##    .drs_flngs_ttn_ 1539.259  390.781    3.939    0.000
##    .drs_flngs_cr_p  854.744  343.692    2.487    0.013
##    .drs_flngs_knw_  674.489  274.379    2.458    0.014
##    .ders_upst_ck_p  813.010  249.011    3.265    0.001
##    .drs_pst_ngry_p  771.454  257.955    2.991    0.003
##    .drs_pst_cntrl_  371.548  123.848    3.000    0.003
##    .drs_pst_dffcl_  890.127  253.745    3.508    0.000
##    .drs_pst_mbrrs_  909.902  298.617    3.047    0.002
##    .ders_pst_fcs_p  427.696  158.159    2.704    0.007
##    .drs_pst_t_cnt_ 1062.867  289.565    3.671    0.000
##    .drs_pst_shmd_p  644.235  201.146    3.203    0.001
##    .drs_pst_bhvr__ 2586.715  451.488    5.729    0.000
##    .drs_pst_dprss_ 1106.487  269.756    4.102    0.000
##    .ders_pst_stm_p  901.646  241.954    3.727    0.000
##    .drs_pst_fl_bt_  751.413  192.760    3.898    0.000
##    .drs_pst_glty_p 1318.051  322.353    4.089    0.000
##    .drs_pst_rrttn_  534.993  171.841    3.113    0.002
##    .ders_upst_tm_p 1771.492  359.545    4.927    0.000
##    .ders_upst_wk_p 3005.514  507.729    5.920    0.000
##    .drs_pst_bhvr_p  331.459  106.528    3.111    0.002
##    .drs_pst_bttr_p 1897.752  392.567    4.834    0.000
##    .drs_pst_cncnt_  561.320  186.090    3.016    0.003
##    .drs_pst_mtn_v_  921.990  256.741    3.591    0.000
##    .drs_pst_fxtn_p  480.142  158.951    3.021    0.003
##    .drs_pst_lng___  721.445  217.179    3.322    0.001
##    .drs_pst_ls_cn_  487.095  161.691    3.012    0.003
##     b              1362.952  424.069    3.214    0.001
##     c              1920.212  424.074    4.528    0.000
##    .a              1342.507  419.220    3.202    0.001
##     d               998.399  337.969    2.954    0.003</code></pre>
</div>
<div id="modification-indices" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Modification indices</h3>
<p>Not all models fit well. When they don’t it is often evidence that something in the model is mis-specified (e.g., forced to 0, when it should be estimated). <strong>Modification indices</strong> give you hints at which parameters you might want to free and they are easy to get with the <code>modindices()</code> function.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="structural-equation-modeling.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(fit, <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">maximum.number =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##                        lhs op                      rhs       mi      epc sepc.lv
## 32                       b ~~                        c 3645.559 1344.429   0.831
## 190  ders_attn_awareness_p ~~    ders_clear_feelings_p 2936.500  454.475 454.475
## 367     ders_upset_angry_p ~~ ders_upset_embarrassed_p 2263.767  645.209 645.209
## 509 ders_upset_depressed_p ~~        ders_upset_time_p 2124.146  878.919 878.919
## 296   ders_feelings_care_p ~~     ders_feelings_know_p 1691.296  484.229 484.229
##     sepc.all sepc.nox
## 32     0.831    0.831
## 190    1.024    1.024
## 367    0.770    0.770
## 509    0.628    0.628
## 296    0.638    0.638</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-machine-learning.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/iancero/musc_r_course_2021/edit/main/structural_equation_modeling.Rmd",
"text": "Find a typo? Please suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
